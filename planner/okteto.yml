name: planner-deploy

build:
  planner-deploy:
    image: okteto.dev/planner-deploy
    context: .

deploy:
  - kubectl apply -f k8s
  - kubectl rollout restart deploy planner-deploy

dev:
  planner-deploy:
    image: maven:3.8.4-openjdk-17
    command:
      - mvn
      - spring-boot:run
    volumes:
      - /root/.m2
    workdir: /src
    sync:
      - :/src
    forward:
      - 8080:8080
      - 5005:5005
      - 35729:35729
